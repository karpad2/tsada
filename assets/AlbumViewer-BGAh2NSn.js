import{u as f,g as S,D as w,b as g,S as b,d as i,Q as F,e as C,_ as B,r as x,c,a as n,t as u,h as y,i as h,w as p,o as m,k,F as L,f as V}from"./index-GeyPVWHc.js";const D={name:"SlideModules",components:{},mounted(){const e=f();this.admin=e.userLoggedin,this.load_courses_base(),S.fromTo(".becsuszo_kep",{opacity:0,x:"150%"},{duration:1.5,opacity:1,x:0})},data:()=>({admin:!1,images:[],showed:[],title:"",options_for_image_viewer:{title:!1},courses:[{img:"https://dummyimage.com/720x400",imga:"",subtitle:"SUBTITLE",title:"First",text:"Lorem ipsum dolor sit"}]}),props:{mode:String,caption:Boolean,id:String},methods:{async load_courses_base(){this.courses=[],this.images=[];const e=new w(g),a=new b(g),d=f();let o;o=await e.getDocument(i.website_db,i.gallery,this.id,[F.select(["title_hu","title_en","title_rs"])]);let s=d.language;s=="en"?this.title=o.title_en:s=="hu"?this.title=o.title_hu:(s=="rs"||s=="sr")&&(this.title=C(o.title_rs)),document.title=this.title;let t=await e.listDocuments(i.website_db,i.album_images,[F.equal("gallery",this.id)]);for(const l of t.documents){let r={img:"",id:""};r.img=await a.getFilePreview(i.gallery_pictures_storage,l.image_id,700,0,"center",90,5,"FFFFFF",15,1,0,"FFFFFF","webp").href,r.id=l.image_id,await a.getFilePreview(i.gallery_pictures_storage,l.image_id,700,0,"center",90,5,"FFFFFF",15,1,0,"FFFFFF","webp").href,this.courses.push({img:r.img,id:l.$id}),this.images.push(r.img)}},isHidden(e){return!e},editmode(){this.$router.push("/admin/gallery-edit/"+this.id)},loaded(e){this.showed.push(e)},async deletebrokenimages(){const e=this.images.filter(a=>!this.showed.includes(a));for(const a of e){const d=new b(g),o=new w(g),s=this.courses.find(t=>t.img===a);if(s&&s.id)try{await o.deleteDocument(i.website_db,i.album_images,s.id),await d.deleteFile(i.gallery_pictures_storage,s.id),this.images=this.images.filter(t=>t!==a),this.courses=this.courses.filter(t=>t.id!==s.id)}catch(t){console.error("Failed to delete broken image: ",t)}}}}},I={class:"text-gray-600 body-font p-5",id:"courses",style:{"min-height":"70vh"}},$={class:"container px-5 mx-auto"},N={key:0,class:"flex flex-wrap w-full mb-20"},T={class:"lg:w-1/3 w-full mb-6 lg:mb-0"},z={class:"sm:text-3xl text-2xl font-medium title-font mb-2 text-gray-900 dark:text-white"},A=n("div",{class:"h-1 w-20 bg-sky-500/100 rounded"},null,-1),E={key:1,class:"mb-5 mt-5"},P=n("div",{class:"flex flex-wrap -m-4"},null,-1),Q={style:{"min-width":"273px"},class:"align-middle transition items-center delay-150 bg-slate-100/30 backdrop-filter hover:bg-sky-400/60 dark:bg-slate-300/30 p-6 rounded-lg shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)]"},j=["onLoad","src"];function q(e,a,d,o,s,t){const l=x("VBtn"),r=x("viewer");return m(),c("section",I,[n("div",$,[d.caption?(m(),c("div",N,[n("div",T,[n("h1",z,u(e.title),1),A])])):y("",!0),e.admin?(m(),c("div",E,[h(l,{class:"m-5",onClick:t.editmode},{default:p(()=>[k(u(e.$t("edit_gallery")),1)]),_:1},8,["onClick"]),h(l,{class:"m-5",onClick:t.deletebrokenimages},{default:p(()=>[k(u(e.$t("delete_broken_images")),1)]),_:1},8,["onClick"])])):y("",!0),P,h(r,{images:e.images,onInited:e.inited,class:"flex flex-wrap flex-row",ref:"viewer",options:e.options_for_image_viewer},{default:p(v=>[(m(!0),c(L,null,V(v.images,_=>(m(),c("div",{key:_,class:"xl:w-1/5 md:w-1/2 sm:w-full p-4 cursor-pointer becsuszo_kep"},[n("div",Q,[n("img",{onLoad:H=>t.loaded(_),style:{height:"272px"},class:"object-contain",src:_},null,40,j)])]))),128))]),_:1},8,["images","onInited","options"])])])}const U=B(D,[["render",q]]);export{U as A};
