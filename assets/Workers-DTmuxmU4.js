import{L as j,u as x,g as v,D as N,b as k,d as o,I as C,S as R,Q as p,e as D,_ as V,r as _,c as b,a as l,t as y,F as B,f as F,h as L,o as u,i as S,w as h,j as T,k as E}from"./index-DhOGi77i.js";const I={name:"Workers",components:{Loading:j},setup(){},mounted(){const t=x();this.admin=t.userLoggedin,document.title=this.$t("workers"),v.fromTo("#render_title",{opacity:0,x:"50%"},{duration:1.5,opacity:1,x:0}),this.admin?this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("contact"),align:"start",key:"contact",width:"300px"},{title:this.$t("photo"),align:"start",key:"img",width:"200px",cellRenderer:function(e){return'<img href="'+e.value+'" class="object-cover w-20" />'}},{title:this.$t("Edit"),align:"start",key:"edit",width:"300px"}]:this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("contact"),align:"start",key:"contact",width:"300px"},{title:this.$t("photo"),align:"start",key:"img",cellRenderer:function(e){return'<img href="'+e.value+'" class="object-cover w-20" />'}}],this.load_workers_base(),this.admin?this.colDefs=[{field:"name",headerName:this.$t("name"),sortable:!0,filter:!0},{field:"contact",headerName:this.$t("contact"),sortable:!0,filter:!0},{field:"img",headerName:this.$t("image"),cellRenderer:function(e){return'<img href="'+e.value+'" class="object-cover w-20" />'}},{field:"edit",headerName:this.$t("edit"),sortable:!0,filter:!0}]:this.colDefs=[{field:"name",headerName:this.$t("name"),sortable:!0,filter:!0},{field:"contact",headerName:this.$t("contact"),sortable:!0,filter:!0},{field:"img",headerName:this.$t("image"),cellRenderer:function(e){return'<img href="'+e.value+'" class="object-cover w-20" />'}}],v.fromTo(".popups",{opacity:0,y:"50%"},{duration:1.5,opacity:1,y:0})},data:()=>({workers:[{img:"https://dummyimage.com/720x400",name:"SUBTITLE",role:"First",contact:"Lorem ipsum dolor sit"}],roles:[],colDefs:[],loaded:!1,headers:[],admin:!1}),methods:{async new_stuff(t){const c=await new N(k).createDocument(o.website_db,o.workers,C.unique(),{roles:t});this.$router.push("/admin/worker/"+c.$id)},async load_workers_base(){const t=x();this.workers=[],this.roles=[];const e=new N(k),c=new R(k);let s=t.language,$=c.getFileView(o.website_images,o.missing_worker_picture).href,g=await e.listDocuments(o.website_db,o.roles_db,[p.orderAsc("listasorrend")]);for(let m=0;m<g.documents.length;m++){let d=g.documents[m],w=[],f=await e.listDocuments(o.website_db,o.workers,[p.select(["worker_name_hu","worker_name_rs","contact","worker_img","$id"]),p.equal("roles",[d.$id])]),a="";s=="en"?a=d.role_en:s=="hu"?a=d.role_hu:(s=="rs"||s=="sr")&&(a=D(d.role_rs)),await f.documents.forEach(async i=>{let n={name:"",contact:"",img:"",id:""};n.id=i.$id,s=="en"||s=="hu"?(n.name=i.worker_name_hu,n.contact=i.contact):(s=="rs"||s=="sr")&&(n.name=D(i.worker_name_rs),n.contact=i.contact),i.worker_img==""||i.worker_img==null?n.img=$:n.img=await c.getFileView(o.website_images,i.worker_img).href,w.push(n)});let r={role:"",workers:[],id:""};r.id=d.$id,r.role=a,r.workers=w,this.roles.push(r)}console.log(this.roles),this.loaded=!0},onReady(t){console.log("onReady")}}},W={class:"text-gray-600 min-h-screen"},q={class:"container px-5 py-20 mx-auto bg-slate-100/30 dark:bg-slate-300/30"},Q={class:"flex flex-wrap w-full mb-20"},A={class:"lg:w-1/3 w-full mb-6 lg:mb-0"},U={id:"render_title",class:"sm:text-3xl text-2xl font-medium title-font mb-2 text-gray-900 dark:text-white"},z={class:"sm:text-2xl text-sm font-medium mb-3 text-gray-900 dark:text-white"},G=["src"];function H(t,e,c,s,$,g){const m=_("router-link"),d=_("v-data-table"),w=_("v-btn"),f=_("Loading");return u(),b("section",W,[l("div",q,[l("div",Q,[l("div",A,[l("h1",U,y(t.$t("workers")),1),e[0]||(e[0]=l("div",{class:"h-1 w-20 bg-sky-500/100 rounded"},null,-1))])]),t.loaded?(u(!0),b(B,{key:0},F(t.roles,a=>(u(),b("div",{class:"m-auto w-full popups",key:a.role},[l("h1",z,y(a.role),1),S(d,{height:"400",headers:t.headers,items:a.workers,"items-per-page":-1},{"item.img":h(({item:r})=>[l("img",{src:r.img,class:"object-cover w-20"},null,8,G)]),"item.edit":h(({item:r})=>[S(m,{class:"",to:"/admin/worker/"+r.id},{default:h(()=>e[1]||(e[1]=[l("i",{class:"pi pi-user-edit worker_editor"},null,-1)])),_:2},1032,["to"])]),bottom:h(()=>e[2]||(e[2]=[])),_:2},1032,["headers","items"]),t.admin?(u(),L(w,{key:0,onClick:r=>g.new_stuff(a.id),class:"m-5"},{default:h(()=>[T(y(t.$t("add_new_worker_in_that_category")),1)]),_:2},1032,["onClick"])):E("",!0)]))),128)):(u(),L(f,{key:1}))])])}const K=V(I,[["render",H]]);export{K as default};
