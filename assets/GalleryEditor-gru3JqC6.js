import{D as m,b as u,S as w,u as U,d as a,Q as y,I as V,_ as $,r as f,c as p,a as n,i as d,w as v,j as c,t as h,F as x,f as q,o as g,k as C,h as M}from"./index--RGfmoMu.js";const B={data(){return{title_en:"",title_hu:"",title_rs:"",short_rs:"",short_hu:"",short_en:"",gallery_id:"",visible:!1,default_image:"",file_link:null,images:[""]}},components:{},mounted(){this.getMD(),this.gallery_id=this.$route.params.id},methods:{async getMD(){const t=new m(u),l=new w(u);U();let o=await t.listDocuments(a.website_db,a.gallery,[y.equal("$id",this.$route.params.id)]);this.title_rs=o.documents[0].title_rs,this.content_rs=o.documents[0].text_rs,this.title_hu=o.documents[0].title_hu,this.content_hu=o.documents[0].text_hu,this.title_en=o.documents[0].title_en,this.content_en=o.documents[0].text_en,this.visible=o.documents[0].visible,this.default_image=o.documents[0].default_image;let r=await t.listDocuments(a.website_db,a.album_images,[y.equal("gallery",this.$route.params.id)]);this.images=[],r.documents.forEach(e=>{let i={img:"",img_id:"",doc_id:""};i.img_id=e.image_id,i.doc_id=e.$id,i.img=l.getFilePreview(a.gallery_pictures_storage,e.image_id,300,0,"center",90,5,"FFFFFF",15,1,0,"FFFFFF","webp").href,this.images.push(i)}),o.documents[0].gallery},async save(){const t=new m(u);await t.listDocuments(a.website_db,a.gallery,[y.equal("$id",this.$route.params.id)]),await t.updateDocument(a.website_db,a.gallery,this.$route.params.id,{title_rs:this.title_rs,title_hu:this.title_hu,title_en:this.title_en,short_en:this.short_en,short_hu:this.short_hu,short_rs:this.short_rs,visible:this.visible,default_image:this.default_image}),this.$notify(this.$t("saved"))},async delete_content(){await new m(u).deleteDocument(a.website_db,a.gallery,this.$route.params.id),this.$notify(this.$t("deleted")),this.router.push("/home")},async file_upload(){const t=new w(u),l=new m(u);if(!this.file_link){console.warn("no file");return}console.log("file_upload"),await this.file_link.forEach(async o=>{this.$notify({type:"info",text:this.$t("file_upload_started")}),console.log(o);const r=await t.createFile(a.gallery_pictures_storage,V.unique(),o);let e=await l.createDocument(a.website_db,a.album_images,V.unique(),{image_id:r.$id,gallery:this.gallery_id});console.log(e),this.$notify({type:"success",text:this.$t("file_uploaded")}),setTimeout(()=>{this.getMD()},500)})},set_as_default(t){console.log(t),this.default_image=t,this.save(),this.getMD()},delete_picture(t,l){const o=new w(u),r=new m(u);try{let e=o.deleteFile(a.gallery_pictures_storage,t)}catch{console.log("hiba a törlésnél")}try{let e=r.deleteDocument(a.website_db,a.album_images,l)}catch{console.log("hiba a törlésnél")}this.getMD()}}},E={class:"relative mb-4 container px-5 mx-auto bg-white"},N={class:"w-full grid sm:grid-cols-3"},S={class:"card card-compact bg-base-100 w-96 shadow-xl m-5 flex",style:{"max-width":"400px"}},j=["src"],I={class:"card-body"},L={key:0},Q={class:"card-actions justify-end"};function T(t,l,o,r,e,i){const k=f("v-switch"),b=f("v-btn"),F=f("v-file-input"),_=f("v-text-field");return g(),p("div",E,[n("div",null,[d(k,{onChange:i.save,modelValue:e.visible,"onUpdate:modelValue":l[0]||(l[0]=s=>e.visible=s),label:t.$t("visible")},null,8,["onChange","modelValue","label"]),d(b,{onClick:i.save,class:"m-5"},{default:v(()=>[c(h(t.$t("save")),1)]),_:1},8,["onClick"]),d(b,{onClick:i.delete_content},{default:v(()=>[c(h(t.$t("delete")),1)]),_:1},8,["onClick"])]),n("div",null,[d(F,{onChange:i.file_upload,multiple:"",modelValue:e.file_link,"onUpdate:modelValue":l[1]||(l[1]=s=>e.file_link=s),accept:"image/*",label:t.$t("fileupload")},null,8,["onChange","modelValue","label"]),c(" "+h(t.$t("preview"))+" ",1),n("div",N,[(g(!0),p(x,null,q(e.images,s=>(g(),p("div",S,[n("figure",null,[n("img",{src:s.img,alt:"mrow"},null,8,j)]),n("div",I,[e.default_image==s.img_id?(g(),p("p",L,h(t.$t("default_picture")),1)):C("",!0),n("div",Q,[e.default_image!=s.img_id?(g(),M(b,{key:0,onClick:D=>i.set_as_default(s.img_id)},{default:v(()=>[c(h(t.$t("set_as_default")),1)]),_:2},1032,["onClick"])):C("",!0),d(b,{onClick:D=>i.delete_picture(s.img_id,s.doc_id)},{default:v(()=>[c(h(t.$t("delete")),1)]),_:2},1032,["onClick"])])])]))),256))])]),n("div",null,[d(_,{onChange:i.save,modelValue:e.title_rs,"onUpdate:modelValue":l[2]||(l[2]=s=>e.title_rs=s),counter:100,label:t.$t("srb_title"),"hide-details":""},null,8,["onChange","modelValue","label"]),d(_,{onChange:i.save,modelValue:e.short_rs,"onUpdate:modelValue":l[3]||(l[3]=s=>e.short_rs=s),counter:100,label:t.$t("srb_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),n("div",null,[n("div",null,[d(_,{modelValue:e.title_hu,"onUpdate:modelValue":l[4]||(l[4]=s=>e.title_hu=s),counter:100,onChange:i.save,label:t.$t("hu_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(_,{onChange:i.save,modelValue:e.short_hu,"onUpdate:modelValue":l[5]||(l[5]=s=>e.short_hu=s),counter:100,label:t.$t("hu_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),n("div",null,[d(_,{modelValue:e.title_en,"onUpdate:modelValue":l[6]||(l[6]=s=>e.title_en=s),counter:100,onChange:i.save,label:t.$t("en_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(_,{onChange:i.save,modelValue:e.short_en,"onUpdate:modelValue":l[7]||(l[7]=s=>e.short_en=s),counter:100,label:t.$t("en_short"),"hide-details":""},null,8,["onChange","modelValue","label"])])])])}const P=$(B,[["render",T]]);export{P as default};
