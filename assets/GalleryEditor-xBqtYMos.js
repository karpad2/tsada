import{D as h,b as u,S as f,u as U,d as i,Q as v,I as y,_ as q,r as b,c as m,a as o,i as d,w as V,k as p,t as _,F as M,f as E,o as g,h as C}from"./index-CRROx7Hy.js";const N={data(){return{title_en:"",title_hu:"",title_rs:"",short_rs:"",short_hu:"",short_en:"",gallery_id:"",visible:!1,default_image:"",file_link:null,images:[""]}},components:{},mounted(){this.getMD(),this.gallery_id=this.$route.params.id},methods:{async getMD(){const e=new h(u),l=new f(u);U();let n=await e.listDocuments(i.website_db,i.gallery,[v.equal("$id",this.$route.params.id)]);this.title_rs=n.documents[0].title_rs,this.content_rs=n.documents[0].text_rs,this.title_hu=n.documents[0].title_hu,this.content_hu=n.documents[0].text_hu,this.title_en=n.documents[0].title_en,this.content_en=n.documents[0].text_en,this.visible=n.documents[0].visible,this.default_image=n.documents[0].default_image;let c=await e.listDocuments(i.website_db,i.album_images,[v.equal("gallery",this.$route.params.id)]);this.images=[],c.documents.forEach(t=>{let a={img:"",img_id:""};a.img_id=t.image_id,a.img=l.getFilePreview(i.gallery_pictures_storage,t.image_id,700,0,"center",90,5,"FFFFFF",15,1,0,"FFFFFF","webp").href,this.images.push(a)}),n.documents[0].gallery},async save(){const e=new h(u);await e.listDocuments(i.website_db,i.gallery,[v.equal("$id",this.$route.params.id)]),await e.updateDocument(i.website_db,i.gallery,this.$route.params.id,{title_rs:this.title_rs,title_hu:this.title_hu,title_en:this.title_en,short_en:this.short_en,short_hu:this.short_hu,short_rs:this.short_rs,visible:this.visible,default_image:this.default_image}),this.$notify(this.$t("saved"))},async delete_content(){await new h(u).deleteDocument(i.website_db,i.gallery,this.$route.params.id),this.$notify(this.$t("deleted")),this.router.push("/home")},async file_upload(){const e=new f(u),l=new h(u);if(!this.file_link){console.warn("no file");return}console.log("file_upload"),await this.file_link.forEach(async n=>{console.log(n);const c=await e.createFile(i.gallery_pictures_storage,y.unique(),n);let t=await l.createDocument(i.website_db,i.album_images,y.unique(),{image_id:c.$id,gallery:this.gallery_id});console.log(t)}),this.getMD(),this.$notify(this.$t("file_uploaded"))},set_as_default(e){console.log(e),this.default_image=e,this.save(),this.getMD()},delete_picture(e){const l=new f(u),n=new h(u);l.deleteFile(i.gallery_pictures_storage,e),n.deleteDocument(i.website_db,i.album_images,e),this.getMD()}}},S={class:"relative mb-4 container px-5 mx-auto bg-white"},$={class:"flex flex-row w-3/4 grid-cols-3"},x={class:"card card-compact bg-base-100 w-96 shadow-xl m-5",style:{"max-width":"250px"}},B=["src"],I={class:"card-body"},L={key:0},Q={class:"card-actions justify-end"},j=["onClick"],G=["onClick"];function P(e,l,n,c,t,a){const k=b("v-switch"),w=b("v-btn"),F=b("v-file-input"),r=b("v-text-field");return g(),m("div",S,[o("div",null,[d(k,{onChange:a.save,modelValue:t.visible,"onUpdate:modelValue":l[0]||(l[0]=s=>t.visible=s),label:e.$t("visible")},null,8,["onChange","modelValue","label"]),d(w,{onClick:a.save,class:"m-5"},{default:V(()=>[p(_(e.$t("save")),1)]),_:1},8,["onClick"]),d(w,{onClick:a.delete_content},{default:V(()=>[p(_(e.$t("delete")),1)]),_:1},8,["onClick"])]),o("div",null,[d(F,{onChange:a.file_upload,multiple:"",modelValue:t.file_link,"onUpdate:modelValue":l[1]||(l[1]=s=>t.file_link=s),accept:"image/*",label:e.$t("fileupload")},null,8,["onChange","modelValue","label"]),p(" "+_(e.$t("preview"))+" ",1),o("div",$,[(g(!0),m(M,null,E(t.images,s=>(g(),m("div",x,[o("figure",null,[o("img",{src:s.img,alt:"mrow"},null,8,B)]),o("div",I,[t.default_image==s.img_id?(g(),m("p",L,_(e.$t("default_picture")),1)):C("",!0),o("div",Q,[t.default_image!=s.img_id?(g(),m("button",{key:0,onClick:D=>a.set_as_default(s.img_id),class:"btn btn-primary"},_(e.$t("set_as_default")),9,j)):C("",!0),o("button",{onClick:D=>a.delete_picture(s.img_id),class:"btn btn-warning"},_(e.$t("delete")),9,G)])])]))),256))])]),o("div",null,[d(r,{onChange:a.save,modelValue:t.title_rs,"onUpdate:modelValue":l[2]||(l[2]=s=>t.title_rs=s),counter:100,label:e.$t("srb_title"),"hide-details":""},null,8,["onChange","modelValue","label"]),d(r,{onChange:a.save,modelValue:t.short_rs,"onUpdate:modelValue":l[3]||(l[3]=s=>t.short_rs=s),counter:100,label:e.$t("srb_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),o("div",null,[o("div",null,[d(r,{modelValue:t.title_hu,"onUpdate:modelValue":l[4]||(l[4]=s=>t.title_hu=s),counter:100,onChange:a.save,label:e.$t("hu_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(r,{onChange:a.save,modelValue:t.short_hu,"onUpdate:modelValue":l[5]||(l[5]=s=>t.short_hu=s),counter:100,label:e.$t("hu_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),o("div",null,[d(r,{modelValue:t.title_en,"onUpdate:modelValue":l[6]||(l[6]=s=>t.title_en=s),counter:100,onChange:a.save,label:e.$t("en_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(r,{onChange:a.save,modelValue:t.short_en,"onUpdate:modelValue":l[7]||(l[7]=s=>t.short_en=s),counter:100,label:e.$t("en_short"),"hide-details":""},null,8,["onChange","modelValue","label"])])])])}const z=q(N,[["render",P]]);export{z as default};
