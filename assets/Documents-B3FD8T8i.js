import{L as B,u as D,g as S,D as L,b as y,d as r,I as N,S as T,Q as h,e as v,_ as A,r as $,c as w,a as l,t as f,F as E,f as V,i as g,h as F,w as c,k as q,o as p,j as x}from"./index-CExocia-.js";import{m as C}from"./moment-with-locales-LhJZLGdy.js";const I={name:"Workers",components:{Loading:B},setup(){},mounted(){const s=D();this.admin=s.userLoggedin,document.title=this.$t("documents"),S.fromTo("#render_title",{opacity:0,x:"50%"},{duration:1.5,opacity:1,x:0}),this.load_workers_base(),this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("date"),align:"start",key:"date",width:"300px"},{title:this.$t("open_document"),align:"start",key:"open",width:"300px"}],this.admin&&(this.headers.push({title:this.$t("edit_document"),align:"start",key:"edit",width:"300px"}),this.colDefs.push({field:"edit",headerName:this.$t("edit_message"),sortable:!0,filter:!0})),S.fromTo(".popups",{opacity:0,y:"50%"},{duration:1.5,opacity:1,y:0})},data:()=>({workers:[{img:"https://dummyimage.com/720x400",name:"SUBTITLE",role:"First",contact:"Lorem ipsum dolor sit"}],roles:[],colDefs:[],loaded:!1,headers:[],admin:!1,archived:!1}),methods:{rt_time(s){let t=D().language;return t=="rs"||t=="sr"?C.locale("sr"):t=="hu"?C.locale("hu"):t=="en"&&C.locale("en"),C(s).format("LLL")},async new_stuff(s){const t=await new L(y).createDocument(r.website_db,r.documents_db,N.unique(),{documentCategories:s});this.$router.push("/admin/document/"+t.$id)},async archive_stuff(s){const t=await new L(y).updateDocument(r.website_db,r.document_categories_db,s,{archived:!0});console.log(t),this.load_workers_base()},async open_archive(){this.archived=!0,this.load_workers_base()},async load_workers_base(){this.loaded=!1;const s=D();this.workers=[],this.roles=[];const m=new L(y);new T(y);let t=s.language,b,k;b=await m.listDocuments(r.website_db,r.document_categories_db,[h.orderAsc("listasorrend"),h.equal("archived",!1)]),this.archived&&(k=await m.listDocuments(r.website_db,r.document_categories_db,[h.orderAsc("listasorrend"),h.equal("archived",!0)]));for(let n=0;n<b.documents.length;n++){let i=b.documents[n],u=[],_=await m.listDocuments(r.website_db,r.documents_db,[h.equal("documentCategories",[i.$id])]),d="";t=="en"?d=i.category_name_en:t=="hu"?d=i.category_name_hu:(t=="rs"||t=="sr")&&(d=v(i.category_name_rs)),await _.documents.forEach(async e=>{let a={name:"",contact:"",img:"",id:"",doc_id:"",date:""};a.id=e.$id,t=="en"||t=="hu"?(a.name=e.document_title_hu,a.contact=e.contact):(t=="rs"||t=="sr")&&(a.name=v(e.document_title_rs),a.contact=e.contact),e.worker_img==""||e.worker_img==null,a.id=e.$id,a.doc_id=e.document_id,a.date=e.$createdAt,u.push(a)});let o={role:"",workers:[],id:""};o.id=i.$id,o.role=d,o.workers=u,this.roles.push(o)}if(this.archived)for(let n=0;n<k.documents.length;n++){let i=k.documents[n],u=[],_=await m.listDocuments(r.website_db,r.documents_db,[h.equal("documentCategories",[i.$id])]),d="";t=="en"?d=i.category_name_en:t=="hu"?d=i.category_name_hu:(t=="rs"||t=="sr")&&(d=v(i.category_name_rs)),d+=` ~ ${this.$t("archived")}`,await _.documents.forEach(async e=>{let a={name:"",contact:"",img:"",id:"",doc_id:"",date:""};a.id=e.$id,t=="en"||t=="hu"?(a.name=e.document_title_hu,a.contact=e.contact):(t=="rs"||t=="sr")&&(a.name=v(e.document_title_rs),a.contact=e.contact),e.worker_img==""||e.worker_img==null,a.id=e.$id,a.doc_id=e.document_id,a.date=e.$createdAt,u.push(a)});let o={role:"",workers:[],id:""};o.id=i.$id,o.role=d,o.workers=u,this.roles.push(o)}console.log(this.roles),this.loaded=!0},onReady(s){console.log("onReady")}}},z={class:"text-gray-600 min-h-screen"},Q={class:"container px-5 py-20 mx-auto bg-slate-100/30 dark:bg-slate-300/30"},R={class:"flex flex-wrap w-full mb-20"},W={class:"lg:w-1/3 w-full mb-6 lg:mb-0"},j={id:"render_title",class:"sm:text-3xl text-2xl font-medium title-font mb-2 text-gray-900 dark:text-white"},U=l("div",{class:"h-1 w-20 bg-sky-500/100 rounded"},null,-1),G={class:"sm:text-2xl text-sm font-medium mb-3 text-gray-900 dark:text-white"},H=l("i",{class:"pi pi-book icon_size"},null,-1),J=l("i",{class:"pi pi-cloud-upload icon_size"},null,-1),K={key:0},M={key:1};function O(s,m,t,b,k,n){const i=$("router-link"),u=$("v-data-table"),_=$("v-btn"),d=$("Loading");return p(),w("section",z,[l("div",Q,[l("div",R,[l("div",W,[l("h1",j,f(s.$t("documents")),1),U])]),s.loaded?(p(!0),w(E,{key:0},V(s.roles,o=>(p(),w("div",{class:"m-auto w-full popups",key:o.role},[l("h1",G,f(o.role),1),g(u,{height:"400",headers:s.headers,items:o.workers,"items-per-page":-1},{"item.date":c(({item:e})=>[x(f(n.rt_time(e.date)),1)]),"item.open":c(({item:e})=>[g(i,{to:"/document/"+e.doc_id},{default:c(()=>[H]),_:2},1032,["to"])]),"item.edit":c(({item:e})=>[g(i,{to:"/admin/document/"+e.id},{default:c(()=>[J]),_:2},1032,["to"])]),bottom:c(()=>[]),_:2},1032,["headers","items"]),s.admin?(p(),w("div",K,[g(_,{onClick:e=>n.new_stuff(o.id),class:"m-5"},{default:c(()=>[x(f(s.$t("add_new_document_in_that_category")),1)]),_:2},1032,["onClick"]),g(_,{onClick:e=>n.archive_stuff(o.id),class:"m-5"},{default:c(()=>[x(f(s.$t("archive_category")),1)]),_:2},1032,["onClick"])])):q("",!0)]))),128)):(p(),w("div",M,[g(d)])),l("div",null,[s.loaded&&!s.archived?(p(),F(_,{key:0,onClick:n.open_archive,class:"m-5"},{default:c(()=>[x(f(s.$t("show_archive")),1)]),_:1},8,["onClick"])):q("",!0)])])])}const Y=A(I,[["render",O]]);export{Y as default};
