import{D as m,b as _,S,u as C,d as i,Q as x,v as A,I as D,e as N,_ as L,r,c as h,a as u,i as o,w as d,j as g,t as b,k as p,o as f}from"./index-_TI3cJYH.js";import{m as w}from"./moment-with-locales-BrB1tWfU.js";import{A as Q}from"./AlbumViewer-u3e4V2Pz.js";const j={data(){return{title_en:"",title_hu:"",title_rs:"",content_rs:"",content_hu:"",content_en:"",srb_flag:!0,hun_flag:!0,en_flag:!1,visible:!1,documents_flag:!1,album_flag:!1,default_img_link:"",gallery_id:"",file_link:null,fb_message:"",fb_public:!1,img:"",headers:[],colDefs:[],documents:[],doc_loaded:!1}},components:{AlbumViewer:Q},mounted(){this.getMD(),this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("date"),align:"start",key:"date",width:"300px"},{title:this.$t("open_document"),align:"start",key:"open",width:"300px"}],this.headers.push({title:this.$t("edit_document"),align:"start",key:"edit",width:"300px"}),this.colDefs.push({field:"edit",headerName:this.$t("edit_message"),sortable:!0,filter:!0})},methods:{async getMD(){const n=new m(_),t=new S(_);C();let a=await n.listDocuments(i.website_db,i.about_us_db,[x.equal("$id",this.$route.params.id)]);this.title_rs=a.documents[0].title_rs,this.content_rs=a.documents[0].text_rs,this.title_hu=a.documents[0].title_hu,this.content_hu=a.documents[0].text_hu,this.title_en=a.documents[0].title_en,this.content_en=a.documents[0].text_en,this.visible=a.documents[0].visible,a.documents[0].default_image==null||a.documents[0].default_image==""?this.img="https://dummyimage.com/720x400":this.img=t.getFileView(i.website_images,a.documents[0].default_image).toString(),this.gallery_id=a.documents[0].gallery,this.documents_flag=a.documents[0].has_documents,this.album_flag=a.documents[0].has_gallery,this.synchronize_documents()},async save(){const n=new m(_);await n.listDocuments(i.website_db,i.about_us_db,[x.equal("$id",this.$route.params.id)]),await n.updateDocument(i.website_db,i.about_us_db,this.$route.params.id,{title_rs:this.title_rs,title_hu:this.title_hu,title_en:this.title_en,text_en:this.content_en,text_hu:this.content_hu,text_rs:this.content_rs,isHungarian:this.hun_flag,isSerbian:this.srb_flag,isEnglish:this.en_flag,visible:this.visible,has_documents:this.documents_flag,has_gallery:this.album_flag,gallery:this.gallery_id,default_image:this.default_image}),this.$notify(this.$t("saved"))},async share_fb(){let t=await new m(_).getDocument(i.website_db,i.users_settings,"fb_access_token"),a=`https://share.tsada.edu.rs/${this.$route.params.id}`;const y=await A.post(`https://graph.facebook.com/v20.0/${i.pan}/feed`,{message:null,link:a,access_token:t.parameter,published:!0});console.log(y)},async documents_load(){this.save(),this.synchronize_documents()},async gallery_change(){this.gallery_id==null&&(this.gallery_id=await this.new_gallery()),this.save()},rt_time(n){let a=C().language;return a=="rs"||a=="sr"?w.locale("sr"):a=="hu"?w.locale("hu"):a=="en"&&w.locale("en"),w(n).format("LLL")},async new_stuff(){const t=await new m(_).createDocument(i.website_db,i.text_documents,D.unique(),{texts:this.$route.params.id});this.$router.push("/admin/text-document-editor/"+t.$id)},async new_gallery(){return(await new m(_).createDocument(i.website_db,i.gallery,D.unique(),{visible:!1})).$id},async synchronize_documents(){const n=new m(_);if(this.documents_flag){this.doc_loaded=!1,this.documents=[];let a=C().language;await(await n.listDocuments(i.website_db,i.text_documents,[x.equal("texts",[this.$route.params.id])])).documents.forEach(async e=>{let s={name:"",contact:"",img:"",id:"",doc_id:"",date:""};s.id=e.$id,a=="en"||a=="hu"?(s.name=e.document_title_hu,s.contact=e.contact):(a=="rs"||a=="sr")&&(s.name=N(e.document_title_rs),s.contact=e.contact),s.id=e.$id,s.doc_id=e.document_id,s.date=e.$createdAt,this.documents.push(s)}),this.doc_loaded=!0}},async delete_content(){await new m(_).deleteDocument(i.website_db,i.about_us_db,this.$route.params.id),this.$notify(this.$t("deleted")),this.router.push("/home")},async file_upload(){if(!this.file_link){console.warn("no file");return}console.log("file_upload");const t=await new S(_).createFile(i.website_images,D.unique(),this.file_link);this.default_image=t.$id,this.save(),this.getMD(),this.$notify(this.$t("file_uploaded"))}}},z={class:"relative mb-4 container px-5 mx-auto bg-white"},B={class:"flex flex-wrap -m-4"},M={class:"xl:w-1/5 md:w-1/2 p-4 cursor-pointer"},F={class:"bg-slate-100/30 hover:bg-sky-600/30 dark:bg-slate-300/30 p-6 rounded-lg shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)]"},I=["src"],H={key:0},G={key:0},J={key:0},K={key:0},O={class:"m-auto w-full"},P=u("i",{class:"pi pi-book text-5xl"},null,-1),R=u("i",{class:"pi pi-cloud-upload text-5xl"},null,-1),W={key:0},X=u("div",null,[u("div")],-1);function Y(n,t,a,y,e,s){const c=r("v-switch"),v=r("v-btn"),T=r("v-file-input"),V=r("v-text-field"),k=r("QuillEditor"),U=r("router-link"),q=r("v-data-table"),E=r("AlbumViewer");return f(),h("div",z,[u("div",null,[o(c,{onChange:s.save,modelValue:e.visible,"onUpdate:modelValue":t[0]||(t[0]=l=>e.visible=l),label:n.$t("visible")},null,8,["onChange","modelValue","label"]),o(v,{class:"m-5",onClick:s.save},{default:d(()=>[g(b(n.$t("save")),1)]),_:1},8,["onClick"]),o(v,{class:"m-5",onClick:s.delete_content},{default:d(()=>[g(b(n.$t("delete")),1)]),_:1},8,["onClick"]),o(v,{class:"m-5",onClick:s.share_fb},{default:d(()=>[g(b(n.$t("fb_share")),1)]),_:1},8,["onClick"])]),u("div",null,[o(T,{onChange:s.file_upload,modelValue:e.file_link,"onUpdate:modelValue":t[1]||(t[1]=l=>e.file_link=l),accept:"image/*",label:n.$t("fileupload")},null,8,["onChange","modelValue","label"]),g(" "+b(n.$t("preview"))+" ",1),u("div",B,[u("div",M,[u("div",F,[u("img",{class:"h-40 rounded w-full object-cover object-center mb-6 transition duration-300 ease-in-out",src:e.img,alt:"content"},null,8,I)])])])]),u("div",null,[o(c,{onChange:s.save,modelValue:e.srb_flag,"onUpdate:modelValue":t[2]||(t[2]=l=>e.srb_flag=l),label:n.$t("srb")},null,8,["onChange","modelValue","label"]),e.srb_flag?(f(),h("div",H,[o(V,{onChange:s.save,modelValue:e.title_rs,"onUpdate:modelValue":t[3]||(t[3]=l=>e.title_rs=l),counter:100,label:n.$t("srb_title"),"hide-details":""},null,8,["onChange","modelValue","label"]),o(k,{onTextChange:s.save,"content-type":"html",style:{"min-height":"200px"},content:e.content_rs,"onUpdate:content":t[4]||(t[4]=l=>e.content_rs=l),toolbar:"full",theme:"snow"},null,8,["onTextChange","content"])])):p("",!0)]),u("div",null,[o(c,{modelValue:e.hun_flag,"onUpdate:modelValue":t[5]||(t[5]=l=>e.hun_flag=l),onChange:s.save,label:n.$t("hu")},null,8,["modelValue","onChange","label"]),e.hun_flag?(f(),h("div",G,[o(V,{modelValue:e.title_hu,"onUpdate:modelValue":t[6]||(t[6]=l=>e.title_hu=l),counter:100,onChange:s.save,label:n.$t("hu_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),o(k,{"content-type":"html",onTextChange:s.save,style:{"min-height":"200px"},content:e.content_hu,"onUpdate:content":t[7]||(t[7]=l=>e.content_hu=l),toolbar:"full",theme:"snow"},null,8,["onTextChange","content"])])):p("",!0)]),u("div",null,[o(c,{modelValue:e.en_flag,"onUpdate:modelValue":t[8]||(t[8]=l=>e.en_flag=l),onChange:s.save,label:n.$t("en")},null,8,["modelValue","onChange","label"]),e.en_flag?(f(),h("div",J,[o(V,{modelValue:e.title_en,"onUpdate:modelValue":t[9]||(t[9]=l=>e.title_en=l),counter:100,onChange:s.save,label:n.$t("en_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),o(k,{"content-type":"html",onTextChange:s.save,style:{"min-height":"200px"},content:e.content_en,"onUpdate:content":t[10]||(t[10]=l=>e.content_en=l),toolbar:"full",theme:"snow"},null,8,["onTextChange","content"])])):p("",!0)]),u("div",null,[o(c,{modelValue:e.documents_flag,"onUpdate:modelValue":t[11]||(t[11]=l=>e.documents_flag=l),onChange:s.documents_load,label:n.$t("documents_flag")},null,8,["modelValue","onChange","label"]),e.documents_flag?(f(),h("div",K,[u("div",O,[o(q,{height:"400",headers:e.headers,items:e.documents},{"item.date":d(({item:l})=>[g(b(s.rt_time(l.date)),1)]),"item.open":d(({item:l})=>[o(U,{to:"/document/"+l.doc_id},{default:d(()=>[P]),_:2},1032,["to"])]),"item.edit":d(({item:l})=>[o(U,{to:"/admin/text-document-editor/"+l.id},{default:d(()=>[R]),_:2},1032,["to"])]),bottom:d(()=>[]),_:1},8,["headers","items"]),o(v,{onClick:t[12]||(t[12]=l=>s.new_stuff()),class:"m-5"},{default:d(()=>[g(b(n.$t("add_new_document_in_that_category")),1)]),_:1})])])):p("",!0)]),u("div",null,[o(c,{modelValue:e.album_flag,"onUpdate:modelValue":t[13]||(t[13]=l=>e.album_flag=l),onChange:s.gallery_change,label:n.$t("album_flag")},null,8,["modelValue","onChange","label"]),e.album_flag?(f(),h("div",W,[o(E,{caption:!1,id:e.gallery_id},null,8,["id"])])):p("",!0)]),X])}const te=L(j,[["render",Y]]);export{te as default};
