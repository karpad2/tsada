import{D as m,b as r,S as w,u as U,d as i,Q as y,I as V,_ as q,r as f,c as v,a as n,i as d,w as p,k as c,t as h,F as M,f as x,o as g,h as C,j as B}from"./index-D_uuHb3D.js";const E={data(){return{title_en:"",title_hu:"",title_rs:"",short_rs:"",short_hu:"",short_en:"",gallery_id:"",visible:!1,default_image:"",file_link:null,images:[""]}},components:{},mounted(){this.getMD(),this.gallery_id=this.$route.params.id},methods:{async getMD(){const e=new m(r),l=new w(r);U();let o=await e.listDocuments(i.website_db,i.gallery,[y.equal("$id",this.$route.params.id)]);this.title_rs=o.documents[0].title_rs,this.content_rs=o.documents[0].text_rs,this.title_hu=o.documents[0].title_hu,this.content_hu=o.documents[0].text_hu,this.title_en=o.documents[0].title_en,this.content_en=o.documents[0].text_en,this.visible=o.documents[0].visible,this.default_image=o.documents[0].default_image;let u=await e.listDocuments(i.website_db,i.album_images,[y.equal("gallery",this.$route.params.id)]);this.images=[],u.documents.forEach(t=>{let a={img:"",img_id:""};a.img_id=t.image_id,a.img=l.getFilePreview(i.gallery_pictures_storage,t.image_id,300,0,"center",90,5,"FFFFFF",15,1,0,"FFFFFF","webp").href,this.images.push(a)}),o.documents[0].gallery},async save(){const e=new m(r);await e.listDocuments(i.website_db,i.gallery,[y.equal("$id",this.$route.params.id)]),await e.updateDocument(i.website_db,i.gallery,this.$route.params.id,{title_rs:this.title_rs,title_hu:this.title_hu,title_en:this.title_en,short_en:this.short_en,short_hu:this.short_hu,short_rs:this.short_rs,visible:this.visible,default_image:this.default_image}),this.$notify(this.$t("saved"))},async delete_content(){await new m(r).deleteDocument(i.website_db,i.gallery,this.$route.params.id),this.$notify(this.$t("deleted")),this.router.push("/home")},async file_upload(){const e=new w(r),l=new m(r);if(!this.file_link){console.warn("no file");return}console.log("file_upload"),await this.file_link.forEach(async o=>{console.log(o);const u=await e.createFile(i.gallery_pictures_storage,V.unique(),o);let t=await l.createDocument(i.website_db,i.album_images,V.unique(),{image_id:u.$id,gallery:this.gallery_id});console.log(t)}),this.getMD(),this.$notify(this.$t("file_uploaded"))},set_as_default(e){console.log(e),this.default_image=e,this.save(),this.getMD()},delete_picture(e){const l=new w(r),o=new m(r);try{let u=l.deleteFile(i.gallery_pictures_storage,e)}catch{console.log("hiba a törlésnél")}try{let u=o.deleteDocument(i.website_db,i.album_images,e)}catch{console.log("hiba a törlésnél")}this.getMD()}}},N={class:"relative mb-4 container px-5 mx-auto bg-white"},S={class:"w-full grid sm:grid-cols-3"},$={class:"card card-compact bg-base-100 w-96 shadow-xl m-5 flex",style:{"max-width":"400px"}},j=["src"],I={class:"card-body"},L={key:0},Q={class:"card-actions justify-end"};function G(e,l,o,u,t,a){const k=f("v-switch"),b=f("v-btn"),F=f("v-file-input"),_=f("v-text-field");return g(),v("div",N,[n("div",null,[d(k,{onChange:a.save,modelValue:t.visible,"onUpdate:modelValue":l[0]||(l[0]=s=>t.visible=s),label:e.$t("visible")},null,8,["onChange","modelValue","label"]),d(b,{onClick:a.save,class:"m-5"},{default:p(()=>[c(h(e.$t("save")),1)]),_:1},8,["onClick"]),d(b,{onClick:a.delete_content},{default:p(()=>[c(h(e.$t("delete")),1)]),_:1},8,["onClick"])]),n("div",null,[d(F,{onChange:a.file_upload,multiple:"",modelValue:t.file_link,"onUpdate:modelValue":l[1]||(l[1]=s=>t.file_link=s),accept:"image/*",label:e.$t("fileupload")},null,8,["onChange","modelValue","label"]),c(" "+h(e.$t("preview"))+" ",1),n("div",S,[(g(!0),v(M,null,x(t.images,s=>(g(),v("div",$,[n("figure",null,[n("img",{src:s.img,alt:"mrow"},null,8,j)]),n("div",I,[t.default_image==s.img_id?(g(),v("p",L,h(e.$t("default_picture")),1)):C("",!0),n("div",Q,[t.default_image!=s.img_id?(g(),B(b,{key:0,onClick:D=>a.set_as_default(s.img_id)},{default:p(()=>[c(h(e.$t("set_as_default")),1)]),_:2},1032,["onClick"])):C("",!0),d(b,{onClick:D=>a.delete_picture(s.img_id)},{default:p(()=>[c(h(e.$t("delete")),1)]),_:2},1032,["onClick"])])])]))),256))])]),n("div",null,[d(_,{onChange:a.save,modelValue:t.title_rs,"onUpdate:modelValue":l[2]||(l[2]=s=>t.title_rs=s),counter:100,label:e.$t("srb_title"),"hide-details":""},null,8,["onChange","modelValue","label"]),d(_,{onChange:a.save,modelValue:t.short_rs,"onUpdate:modelValue":l[3]||(l[3]=s=>t.short_rs=s),counter:100,label:e.$t("srb_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),n("div",null,[n("div",null,[d(_,{modelValue:t.title_hu,"onUpdate:modelValue":l[4]||(l[4]=s=>t.title_hu=s),counter:100,onChange:a.save,label:e.$t("hu_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(_,{onChange:a.save,modelValue:t.short_hu,"onUpdate:modelValue":l[5]||(l[5]=s=>t.short_hu=s),counter:100,label:e.$t("hu_short"),"hide-details":""},null,8,["onChange","modelValue","label"])]),n("div",null,[d(_,{modelValue:t.title_en,"onUpdate:modelValue":l[6]||(l[6]=s=>t.title_en=s),counter:100,onChange:a.save,label:e.$t("en_title"),"hide-details":""},null,8,["modelValue","onChange","label"]),d(_,{onChange:a.save,modelValue:t.short_en,"onUpdate:modelValue":l[7]||(l[7]=s=>t.short_en=s),counter:100,label:e.$t("en_short"),"hide-details":""},null,8,["onChange","modelValue","label"])])])])}const T=q(E,[["render",G]]);export{T as default};
