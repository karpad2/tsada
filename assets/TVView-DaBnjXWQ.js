import{_ as w,S as x,b as u,x as d,D as g,d as c,Q as b,c as i,a as s,i as y,w as v,V as T,F as _,f as p,t as o,k as f,o as l,n as S,W as k,y as D,z as I,X as M}from"./index-CAnCyNTF.js";const H={data(){return{currentTime:"",currentDate:"",currentTemperature:null,currentSlide:0,slides:[],newsItems:[],events:[],slideBackgrounds:["#f87171","#60a5fa","#34d399","#a78bfa","#fbbf24"],storage:null}},created(){this.storage=new x(u)},methods:{async updateTime(){try{const t=await fetch("https://share.tsada.edu.rs/__time__");if(!t.ok)throw new Error("Failed to fetch time");const r=await t.json();this.currentTime=d(r.date).format("HH:mm:ss"),this.currentDate=d(r.date).format("YYYY-MM-DD")}catch(t){console.warn("Falling back to local time due to error:",t),this.currentTime=d().format("HH:mm:ss"),this.currentDate=d().format("YYYY-MM-DD")}},async fetchContent(){const t=new g(u);try{const r=await t.listDocuments(c.website_db,c.tv_slides,[b.orderAsc("sorrend")]);this.slides=[],this.events=[],r.documents.forEach(n=>{const h=n.image?this.getImageUrl(n.image):null;n.type==="slide"?this.slides.push({title:n.title,text:n.text,image:h,order:n.sorrend}):n.type==="event"&&this.events.push({title:n.title,date:d(n.event_date).format("YYYY-MM-DD"),description:n.description,image:h})})}catch(r){console.error("Error fetching content:",r)}},async fetchNewsItems(){const t=new g(u);try{const r=await t.listDocuments(c.website_db,c.tv_slides);this.newsItems=r.documents.map(n=>n.news_text)}catch(r){console.error("Error fetching news:",r)}},async fetchTemperature(){const t=new g(u);try{let r=await t.getDocument(c.website_db,c.general_settings,"temperature");this.currentTemperature=r.setting_data}catch(r){console.error("Error fetching temperature:",r),this.currentTemperature="N/A"}},getImageUrl(t){return this.storage.getFileView(c.website_images,t).toString()}},mounted(){this.fetchContent(),this.fetchNewsItems(),this.fetchTemperature(),this.updateTime(),setInterval(this.updateTime,1e3),setInterval(()=>{this.slides.length>0&&(this.currentSlide=(this.currentSlide+1)%this.slides.length)},15e3),setInterval(this.fetchContent,3e4)}},Y=t=>(D("data-v-30fcdeea"),t=t(),I(),t),L={class:"relative h-screen w-full overflow-hidden bg-gray-900 text-white"},C={class:"absolute inset-0 flex justify-center items-center",ref:"slides"},j={class:"flex flex-wrap items-center justify-center w-full max-w-5xl"},E={key:0,class:"w-full md:w-1/2 p-4"},V=["src"],B=["innerHTML"],N=["innerHTML"],F={class:"absolute bottom-0 w-full bg-gray-800 text-white flex items-center py-6 px-8"},z=Y(()=>s("img",{src:M,alt:"School Logo",class:"h-16 w-auto mr-6"},null,-1)),U={class:"flex overflow-hidden whitespace-nowrap animate-marquee space-x-12"},A={class:"ml-auto pr-8 text-3xl"},Q={class:"absolute bottom-16 right-8 text-4xl font-bold"},q={class:"absolute top-0 right-0 mt-16 mr-8 w-1/4 bg-gray-800 bg-opacity-70 p-4 rounded-lg shadow-lg"},W={class:"text-4xl font-bold mb-4 text-white"},X={key:0,class:"text-lg text-gray-300"},G=["src"],J={key:1,class:"w-full h-32 bg-gray-600 flex items-center justify-center text-gray-300 rounded-lg mb-2"},K=["innerHTML"],O={class:"text-gray-400 text-sm"},P=["innerHTML"];function R(t,r,n,h,e,Z){return l(),i("div",L,[s("div",C,[y(T,{name:"fade-slide",mode:"out-in"},{default:v(()=>[e.slides.length>0?(l(),i("div",{key:e.currentSlide,class:"flex justify-center items-center w-full h-full px-12",style:S({backgroundColor:e.slideBackgrounds[e.currentSlide%e.slideBackgrounds.length]})},[s("div",j,[e.slides[e.currentSlide].image?(l(),i("div",E,[s("img",{src:e.slides[e.currentSlide].image,alt:"Slide Image",class:"object-cover w-full h-96 rounded-lg shadow-lg"},null,8,V)])):f("",!0),s("div",{class:k([[e.slides[e.currentSlide].image?"w-full md:w-1/2":"w-full"],"p-4"])},[s("h2",{class:"text-5xl font-extrabold mb-4 animate-fade-in-down text-center",innerHTML:e.slides[e.currentSlide].title},null,8,B),s("p",{class:"text-2xl max-w-3xl animate-fade-in-up text-center",innerHTML:e.slides[e.currentSlide].text},null,8,N)],2)])],4)):f("",!0)]),_:1})],512),s("div",F,[z,s("div",U,[(l(!0),i(_,null,p(e.newsItems,(a,m)=>(l(),i("div",{key:m,class:"flex-shrink-0 text-3xl"},o(a),1))),128))]),s("div",A,o(e.currentTemperature?`${e.currentTemperature}Â°C`:t.$t("loading")),1)]),s("div",Q,o(e.currentDate)+" - "+o(e.currentTime),1),s("div",q,[s("h3",W,o(t.$t("events")),1),e.events.length===0?(l(),i("div",X,o(t.$t("noevents")),1)):f("",!0),(l(!0),i(_,null,p(e.events,(a,m)=>(l(),i("div",{key:m,class:"mb-4 border-b border-gray-700 pb-4"},[a.image?(l(),i("img",{key:0,src:a.image,alt:"Event Image",class:"w-full h-32 object-cover rounded-lg mb-2"},null,8,G)):(l(),i("div",J,[s("span",null,o(t.$t("noimage")),1)])),s("h4",{class:"text-2xl font-semibold",innerHTML:a.title},null,8,K),s("p",O,o(a.date),1),s("p",{class:"text-lg",innerHTML:a.description},null,8,P)]))),128))])])}const ee=w(H,[["render",R],["__scopeId","data-v-30fcdeea"]]);export{ee as default};
