import{L as j,u as x,g as v,D as N,b as k,d as o,I as C,S as R,Q as p,e as D,_ as V,r as w,c as b,a as l,t as y,F as B,f as F,h as L,o as h,i as S,w as u,j as T,k as E}from"./index-BwSHkczn.js";const I={name:"Workers",components:{Loading:j},setup(){},mounted(){const e=x();this.admin=e.userLoggedin,document.title=this.$t("workers"),v.fromTo("#render_title",{opacity:0,x:"50%"},{duration:1.5,opacity:1,x:0}),this.admin?this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("contact"),align:"start",key:"contact",width:"300px"},{title:this.$t("photo"),align:"start",key:"img",width:"200px",cellRenderer:function(t){return'<img href="'+t.value+'" class="object-cover w-20" />'}},{title:this.$t("Edit"),align:"start",key:"edit",width:"300px"}]:this.headers=[{title:this.$t("name"),align:"start",sortable:!1,key:"name",width:"200px"},{title:this.$t("contact"),align:"start",key:"contact",width:"300px"},{title:this.$t("photo"),align:"start",key:"img",cellRenderer:function(t){return'<img href="'+t.value+'" class="object-cover w-20" />'}}],this.load_workers_base(),this.admin?this.colDefs=[{field:"name",headerName:this.$t("name"),sortable:!0,filter:!0},{field:"contact",headerName:this.$t("contact"),sortable:!0,filter:!0},{field:"img",headerName:this.$t("image"),cellRenderer:function(t){return'<img href="'+t.value+'" class="object-cover w-20" />'}},{field:"edit",headerName:this.$t("edit"),sortable:!0,filter:!0}]:this.colDefs=[{field:"name",headerName:this.$t("name"),sortable:!0,filter:!0},{field:"contact",headerName:this.$t("contact"),sortable:!0,filter:!0},{field:"img",headerName:this.$t("image"),cellRenderer:function(t){return'<img href="'+t.value+'" class="object-cover w-20" />'}}],v.fromTo(".popups",{opacity:0,y:"50%"},{duration:1.5,opacity:1,y:0})},data:()=>({workers:[{img:"https://dummyimage.com/720x400",name:"SUBTITLE",role:"First",contact:"Lorem ipsum dolor sit"}],roles:[],colDefs:[],loaded:!1,headers:[],admin:!1}),methods:{async new_stuff(e){const d=await new N(k).createDocument(o.website_db,o.workers,C.unique(),{roles:e});this.$router.push("/admin/worker/"+d.$id)},async load_workers_base(){const e=x();this.workers=[],this.roles=[];const t=new N(k),d=new R(k);let s=e.language,$=d.getFileView(o.website_images,o.missing_worker_picture).href,_=await t.listDocuments(o.website_db,o.roles_db,[p.orderAsc("listasorrend")]);for(let m=0;m<_.documents.length;m++){let c=_.documents[m],g=[],f=await t.listDocuments(o.website_db,o.workers,[p.select(["worker_name_hu","worker_name_rs","contact","worker_img","$id"]),p.equal("roles",[c.$id])]),a="";s=="en"?a=c.role_en:s=="hu"?a=c.role_hu:(s=="rs"||s=="sr")&&(a=D(c.role_rs)),await f.documents.forEach(async i=>{let n={name:"",contact:"",img:"",id:""};n.id=i.$id,s=="en"||s=="hu"?(n.name=i.worker_name_hu,n.contact=i.contact):(s=="rs"||s=="sr")&&(n.name=D(i.worker_name_rs),n.contact=i.contact),i.worker_img==""||i.worker_img==null?n.img=$:n.img=await d.getFileView(o.website_images,i.worker_img).href,g.push(n)});let r={role:"",workers:[],id:""};r.id=c.$id,r.role=a,r.workers=g,this.roles.push(r)}console.log(this.roles),this.loaded=!0},onReady(e){console.log("onReady")}}},W={class:"text-gray-600 min-h-screen"},q={class:"container px-5 py-20 mx-auto bg-slate-100/30 dark:bg-slate-300/30"},Q={class:"flex flex-wrap w-full mb-20"},A={class:"lg:w-1/3 w-full mb-6 lg:mb-0"},U={id:"render_title",class:"sm:text-3xl text-2xl font-medium title-font mb-2 text-gray-900 dark:text-white"},z=l("div",{class:"h-1 w-20 bg-sky-500/100 rounded"},null,-1),G={class:"sm:text-2xl text-sm font-medium mb-3 text-gray-900 dark:text-white"},H=["src"],J=l("i",{class:"pi pi-user-edit worker_editor"},null,-1);function K(e,t,d,s,$,_){const m=w("router-link"),c=w("v-data-table"),g=w("v-btn"),f=w("Loading");return h(),b("section",W,[l("div",q,[l("div",Q,[l("div",A,[l("h1",U,y(e.$t("workers")),1),z])]),e.loaded?(h(!0),b(B,{key:0},F(e.roles,a=>(h(),b("div",{class:"m-auto w-full popups",key:a.role},[l("h1",G,y(a.role),1),S(c,{height:"400",headers:e.headers,items:a.workers,"items-per-page":-1},{"item.img":u(({item:r})=>[l("img",{src:r.img,class:"object-cover w-20"},null,8,H)]),"item.edit":u(({item:r})=>[S(m,{class:"",to:"/admin/worker/"+r.id},{default:u(()=>[J]),_:2},1032,["to"])]),bottom:u(()=>[]),_:2},1032,["headers","items"]),e.admin?(h(),L(g,{key:0,onClick:r=>_.new_stuff(a.id),class:"m-5"},{default:u(()=>[T(y(e.$t("add_new_worker_in_that_category")),1)]),_:2},1032,["onClick"])):E("",!0)]))),128)):(h(),L(f,{key:1}))])])}const O=V(I,[["render",K]]);export{O as default};
