import{q as p,u as l,G as f,b as v,H as V,J as L,_ as C,r as d,c as g,a as t,t as i,K as U,h as r,i as u,w,o as m,k as b}from"./index-DOnasCvk.js";const B={name:"Login",data(){return{animation_backgound:!1,user_name:"",uid:""}},setup(){const e=p(""),s=p("");return{email:e,password:s}},mounted(){const e=l();document.title=this.$t("login"),this.checklogin(),e.isLoggedin&&this.get_user_settings(),console.log("login")},methods:{async checklogin(){const e=l();e.setUserLoggedin(!1);const s=new f(v);try{const o=await s.get();console.log(o),e.setUserLoggedin(!0)}catch{e.setUserLoggedin(!1)}},async get_user_settings(){},async set_user_setting(){l().setAnimation(this.animation_backgound),console.log("setted_animation")},login_by_app(){const e=V.createEmailPasswordSession(this.email,this.password),s=l();e.then(o=>{console.log(o),this.$notify(this.$t("success")),l().setUserLoggedin(!0),console.log(o),s.setuid(o.userId)},o=>{this.$notify(this.$t("login_failure")),console.log(o)})},async logout(){l().setUserLoggedin(!1),await new f(v).deleteSession("current"),console.warn("logout"),L.push("/home")},animation_setting(){}},computed:{isLoggedin(){return l().userLoggedin}}},S={class:""},$={key:0},N={class:"font-[sans-serif]"},A={class:"min-h-screen flex flex-col items-center justify-center px-4"},j={class:"max-w-md w-full"},E={class:"p-8 rounded-2xl dark:bg-slate-700 shadow"},I={class:"text-gray-800 text-center text-2xl font-bold dark:text-white"},T={class:"relative flex items-center"},q={class:"relative flex items-center"},D=t("div",{class:"flex flex-wrap items-center justify-between gap-4"},[t("div",{class:"flex items-center"}),t("div",{class:"text-sm"})],-1),G={class:"!mt-8"},H={key:1,class:"w-1/2 h-full m-auto p-40"};function J(e,s,o,c,_,a){const h=d("v-text-field");d("InputText");const y=d("v-btn"),k=d("v-switch"),x=d("VBtn");return m(),g("div",S,[a.isLoggedin?(m(),g("div",H,[t("h1",null,i(e.$t("Account page")),1),t("h2",null,i(e.$t("welcome"))+" "+i()+" !",1),t("div",null,[u(k,{onChange:a.set_user_setting,modelValue:_.animation_backgound,"onUpdate:modelValue":s[6]||(s[6]=n=>_.animation_backgound=n),label:e.$t("disable_animation_background")},null,8,["onChange","modelValue","label"])]),u(x,{onClick:a.logout},{default:w(()=>[b(i(e.$t("logout")),1)]),_:1},8,["onClick"])])):(m(),g("div",$,[t("div",N,[t("div",A,[t("div",j,[t("div",E,[t("h2",I,i(e.$t("login")),1),t("form",{onSubmit:s[5]||(s[5]=U((...n)=>a.login_by_app&&a.login_by_app(...n),["prevent"])),class:"mt-8 space-y-4"},[t("div",null,[r("",!0),t("div",T,[u(h,{type:"email",modelValue:c.email,"onUpdate:modelValue":s[0]||(s[0]=n=>c.email=n),label:e.$t("email")},null,8,["modelValue","label"]),r("",!0)])]),t("div",null,[r("",!0),t("div",q,[u(h,{type:"password",modelValue:c.password,"onUpdate:modelValue":s[2]||(s[2]=n=>c.password=n),label:e.$t("password")},null,8,["modelValue","label"]),r("",!0)])]),D,t("div",G,[u(y,{onClick:a.login_by_app},{default:w(()=>[b(i(e.$t("login")),1)]),_:1},8,["onClick"]),r("",!0)])],32)])])])])]))])}const M=C(B,[["render",J]]);export{M as default};
